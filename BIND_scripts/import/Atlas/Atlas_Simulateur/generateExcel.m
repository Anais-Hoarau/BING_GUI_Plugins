    cd('C:\Documents and Settings\matlab\Bureau\Atlas');
    varList = {
        './03/sc8/atlas.trip', '8';
        './03/sc7/atlas.trip', '7';
        './03/sc6/atlas.trip', '6';
        './03/sc5/atlas.trip', '5';
        './03/sc2/atlas.trip', '2';
        './03/sc1/atlas.trip', '1';
        './05/sc8/atlas.trip', '8';
        './05/sc7/22071059.trip', '7';
        './05/sc6/22071048.trip', '6';
        './05/sc5/22071040.trip', '5';
        './05/sc2/22071019.trip', '2';
        './05/sc1/22071009.trip', '1';
        './06/sc8/25072041.trip', '8';
        './06/sc7/25072030.trip', '7';
        './06/sc6/25072002.trip', '6';
        './06/sc6/25072005.trip', '6';
        './06/sc6/25072012.trip', '6';
        './06/sc5/25071950.trip', '5';
        './06/sc2/25071933.trip', '2';
        './06/sc1/25071922.trip', '1';
        './07/sc8/atlas.trip', '8';
        './07/sc7/26071533.trip', '7';
        './07/sc6/26071518.trip', '6';
        './07/sc5/26071507.trip', '5';
        './07/sc2/26071450.trip', '2';
        './07/sc1/26071441.trip', '1';
        './08/sc8/27071558.trip', '8';
        './08/sc6/27071519.trip', '6';
        './08/sc6/27071527.trip', '6';
        './08/sc6/27071528.trip', '6';
        './08/sc5/27071507.trip', '5';
        './08/sc2/27071446.trip', '2';
        './08/sc1/27071437.trip', '1';
        './09/sc8/27071911.trip', '8';
        './09/sc8/27071915.trip', '8';
        './09/sc7/27071859.trip', '7';
        './09/sc6/27071839.trip', '6';
        './09/sc5/27071828.trip', '5';
        './09/sc2/27071812.trip', '2';
        './09/sc1/27071803.trip', '1';
        './10/sc8/28071556.trip', '8';
        './10/sc7/28071544.trip', '7';
        './10/sc6/28071526.trip', '6';
        './10/sc6/28071527.trip', '6';
        './10/sc6/28071542.trip', '6';
        './10/sc5/28071512.trip', '5';
        './10/sc2/28071454.trip', '2';
        './10/sc2/28071456.trip', '2'
        './10/sc2/28071458.trip', '2';
        './10/sc1/atlas.trip', '1';
        %'./11/sc8/28071827.trip', '8';
        './11/sc7/28071812.trip', '7';
        './11/sc6/28071750.trip', '6';
        './11/sc5/28071740.trip', '5';
        './11/sc2/28071727.trip', '2';
        './11/sc1/28071717.trip', '1';
        './12/sc8/29071105.trip', '8';
        './12/sc8/29071108.trip', '8';
        './12/sc7/29071046.trip', '7';
        './12/sc7/29071048.trip', '7';
        './12/sc6/29071026.trip', '6';
        './12/sc6/29071027.trip', '6';
        './12/sc5/29071011.trip', '5';
        './12/sc2/29070953.trip', '2';
        './12/sc1/29070945.trip', '1';
        './13/sc8/01081112.trip', '8';
        './13/sc7/01081032.trip', '7';
        './13/sc6/atlas.trip', '6';
        './13/sc5/01080959.trip', '5';
        './13/sc2/01080942.trip', '2';
        './13/sc1/atlas.trip', '1';
        './14/sc8/02081858.trip', '8';
        './14/sc7/02081847.trip', '7';
        './14/sc6/atlas.trip', '6';
        './14/sc5/02081817.trip', '5';
        './14/sc2/02081740.trip', '2';
        './14/sc1/atlas.trip', '1';
        './15/sc8/03081108.trip', '8';
        './15/sc7/03081057.trip', '7';
        './15/sc6/03081045.trip', '6';
        './15/sc5/03081035.trip', '5';
        './15/sc2/03081015.trip', '2';
        './15/sc1/03081009.trip', '1';
        './04/sc8/atlas.trip', '8';
        './04/sc7/atlas.trip', '7';
        './04/sc6/atlas.trip', '6';
        './04/sc5/atlas.trip', '5';
        './04/sc2/atlas.trip', '2';
        './04/sc1/atlas.trip', '1'
    };

numberOfTrips = size(varList, 1);
xlsContent = cell(numberOfTrips + 1, 11);
%On remplit l'en-tête
xlsContent{1, 1} = 'fichier';
xlsContent{1, 2} = 'participant';
xlsContent{1, 3} = 'scenario';
xlsContent{1, 4} = 'type situation';
xlsContent{1, 5} = 'id situation';
xlsContent{1, 6} = 'speedLimit';
xlsContent{1, 7} = 'mean_deviation_to_prescripted_speed';
xlsContent{1, 8} = 'jerk';
xlsContent{1, 9} = 'lane_deviation';
xlsContent{1, 10} = 'mean_brake_percentage';
xlsContent{1, 11} = 'max_brake_percentage';


lineIndex = 2;
for i = 1:1:numberOfTrips
    fichier = varList{i, 1};
    disp(['Traitement de ' fichier]);
    participant =  regexp(fichier, '(?<=^\.\/)\d\d', 'match');
    scenario = regexp(fichier, '(?<=^\.\/\d\d\/)sc\d', 'match');
    trip = fr.lescot.bind.kernel.implementation.SQLiteTrip(fichier, 0.04, false);
    situationsRecords = trip.getAllSituationOccurences('Sections');
    types = situationsRecords.getVariableValues('type');
    identifiers = situationsRecords.getVariableValues('identifier');
    speedLimits = situationsRecords.getVariableValues('speedLimit');
    speedDeviations = situationsRecords.getVariableValues('mean_deviation_to_prescripted_speed');
    jerks  = situationsRecords.getVariableValues('jerk');
    laneDeviations = situationsRecords.getVariableValues('lane_deviation');
    meanBrakes = situationsRecords.getVariableValues('mean_break_percentage');
    maxBrakes = situationsRecords.getVariableValues('max_break_percentage');
    for j = 1:1:length(types)
        xlsContent{lineIndex, 1} = fichier;
        xlsContent{lineIndex, 2} = participant{1};
        xlsContent{lineIndex, 3} = scenario{1};
        xlsContent{lineIndex, 4} = types{j};
        xlsContent{lineIndex, 5} = identifiers{j};
        xlsContent{lineIndex, 6} = speedLimits{j};
        xlsContent{lineIndex, 7} = speedDeviations{j};
        xlsContent{lineIndex, 8} = jerks{j};
        xlsContent{lineIndex, 9} = laneDeviations{j};  
        xlsContent{lineIndex, 10} = meanBrakes{j};
        xlsContent{lineIndex, 11} = maxBrakes{j};
        lineIndex = lineIndex + 1;
    end
    trip.delete();
end

xlswrite('atlas.xls', xlsContent);